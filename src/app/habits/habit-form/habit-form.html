<div class="container mx-auto p-6 max-w-2xl">
  <!-- Header -->
  <div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-800">
      {{ isEditMode ? 'Edit Habit' : 'Create New Habit' }}
    </h1>
    <p class="text-gray-600 mt-1">
      {{ isEditMode ? 'Update your habit details' : 'Add a new habit to track your progress' }}
    </p>
  </div>

  <!-- Messages -->
  <div *ngIf="errorMessage" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6">
    {{ errorMessage }}
  </div>

  <div *ngIf="successMessage" class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-6">
    {{ successMessage }}
  </div>

  <!-- Loading -->
  <div *ngIf="isLoading && isEditMode" class="text-center py-8">
    <div class="inline-block animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-blue-600"></div>
    <p class="mt-2 text-gray-600">Loading habit details...</p>
  </div>

  <!-- Form -->
  <form *ngIf="!isLoading || !isEditMode" (ngSubmit)="onSubmit()" class="bg-white p-6 rounded-lg shadow-md">
    <!-- Title -->
    <div class="mb-6">
      <label class="block text-sm font-medium mb-2 text-gray-700">
        Title *
      </label>
      <input
        type="text"
        [(ngModel)]="habit.title"
        name="title"
        required
        class="w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        placeholder="e.g., Exercise, Reading, Meditation"
      >
    </div>

    <!-- Description -->
    <div class="mb-6">
      <label class="block text-sm font-medium mb-2 text-gray-700">
        Description
      </label>
      <textarea
        [(ngModel)]="habit.description"
        name="description"
        rows="3"
        class="w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
        placeholder="Brief description of your habit..."
      ></textarea>
    </div>

    <!-- Frequency -->
    <div class="mb-6">
      <label class="block text-sm font-medium mb-2 text-gray-700">
        Frequency *
      </label>
      <select
        [(ngModel)]="habit.frequency"
        name="frequency"
        (change)="onFrequencyChange()"
        class="w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
      >
        <option value="daily">Daily</option>
        <option value="weekly">Weekly</option>
        <option value="custom">Custom</option>
      </select>
    </div>

    <!-- Days Selection (for custom frequency) -->
    <div *ngIf="habit.frequency === 'custom'" class="mb-6">
      <label class="block text-sm font-medium mb-2 text-gray-700">
        Select Days *
      </label>
      <div class="grid grid-cols-2 md:grid-cols-4 gap-2">
        <label *ngFor="let day of daysOfWeek" class="flex items-center">
          <input
            type="checkbox"
            [checked]="day.selected"
            (change)="toggleDaySelection(day)"
            class="mr-2 h-4 w-4 text-blue-600 rounded"
          >
          <span class="text-sm text-gray-700">{{ day.name }}</span>
        </label>
      </div>
    </div>

    <!-- Reminder Time -->
    <div class="mb-6">
      <label class="block text-sm font-medium mb-2 text-gray-700">
        Reminder Time (Optional)
      </label>
      <input
        type="time"
        [(ngModel)]="habit.reminderTime"
        name="reminderTime"
        class="w-full border border-gray-300 p-3 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
      >
    </div>

    <!-- Color -->
    <div class="mb-6">
      <label class="block text-sm font-medium mb-2 text-gray-700">
        Color (Optional)
      </label>
      <input
        type="color"
        [(ngModel)]="habit.color"
        name="color"
        class="w-full h-10 p-1 border border-gray-300 rounded-lg"
        value="#4caf50"
      >
    </div>

    <!-- Dates -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
      <div>
        <label class="block text-sm font-medium mb-2 text-gray-700">
          Start Date (Optional)
        </label>
        <input
          type="date"
          [(ngModel)]="habit.startDate"
          name="startDate"
          class="w-full border border-gray-300 p-3 rounded-lg"
        >
      </div>
      <div>
        <label class="block text-sm font-medium mb-2 text-gray-700">
          End Date (Optional)
        </label>
        <input
          type="date"
          [(ngModel)]="habit.endDate"
          name="endDate"
          class="w-full border border-gray-300 p-3 rounded-lg"
        >
      </div>
    </div>

    <!-- Buttons -->
    <div class="flex justify-end space-x-4 pt-4">
      <button
        type="button"
        (click)="cancel()"
        class="px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition"
      >
        Cancel
      </button>
      <button
        type="submit"
        [disabled]="isLoading"
        class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-300 transition"
      >
        {{ isLoading ? 'Saving...' : (isEditMode ? 'Update Habit' : 'Create Habit') }}
      </button>
    </div>
  </form>
</div>